Melb.trainStratified.LM.6.2<-lm.beta(Melb.trainStratified.LM.6.2)
summary(Melb.trainStratified.LM.6.2)
capture.output(summary(Melb.trainStratified.LM.6.1), file = "trainStratified.MA.txt")
summary(Melb.trainStratified.LM.6.2)
#LU Entropy
Melb.trainStratified.LM.6.3<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance +X10_HousingDiv + X13_DestScore + X15_Parkiteer + X16_CBDDist +X17_ACDist + X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+ X29_MeanSize + X31_PropOS + X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.3<-lm.beta(Melb.trainStratified.LM.6.3)
summary(Melb.trainStratified.LM.6.3)
#AcDist
Melb.trainStratified.LM.6.4<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance +X10_HousingDiv + X13_DestScore + X15_Parkiteer + X16_CBDDist +X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+ X29_MeanSize + X31_PropOS + X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.4<-lm.beta(Melb.trainStratified.LM.6.4)
summary(Melb.trainStratified.LM.6.4)
#PropComm
Melb.trainStratified.LM.6.5<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance +X10_HousingDiv + X13_DestScore + X15_Parkiteer + X16_CBDDist +X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+ X29_MeanSize + X31_PropOS + X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.5<-lm.beta(Melb.trainStratified.LM.6.5)
summary(Melb.trainStratified.LM.6.5)
#MeanSize
Melb.trainStratified.LM.6.6<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance +X10_HousingDiv + X13_DestScore + X15_Parkiteer + X16_CBDDist +X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+X31_PropOS + X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.6<-lm.beta(Melb.trainStratified.LM.6.6)
summary(Melb.trainStratified.LM.6.6)
#DestScore
Melb.trainStratified.LM.6.7<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance +X10_HousingDiv +X15_Parkiteer + X16_CBDDist +X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+X31_PropOS + X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.7<-lm.beta(Melb.trainStratified.LM.6.7)
summary(Melb.trainStratified.LM.6.7)
#PropOS
Melb.trainStratified.LM.6.8<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance +X10_HousingDiv +X15_Parkiteer + X16_CBDDist +X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.8<-lm.beta(Melb.trainStratified.LM.6.8)
summary(Melb.trainStratified.LM.6.8)
#HousingDiv
Melb.trainStratified.LM.6.9<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance +X15_Parkiteer + X16_CBDDist +X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.9<-lm.beta(Melb.trainStratified.LM.6.9)
summary(Melb.trainStratified.LM.6.9)
#Population density
Melb.trainStratified.LM.6.10<-lm(X1ln.ln_Patronage ~ X8_Balance +X15_Parkiteer + X16_CBDDist +X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+X32_PropBach, data = Stratifiedsample.train.800.rd3)
Melb.trainStratified.LM.6.10<-lm.beta(Melb.trainStratified.LM.6.10)
summary(Melb.trainStratified.LM.6.10)
Train.Stratified.PM.v2.VIF<- vif(Melb.trainStratified.LM.6.10)
Train.Stratified.PM.v2.VIF
plot(Melb.trainStratified.LM.6.10)
#rd 7
Melb.trainStratified.LM.7.1<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +  X11_IntDensity + X13_DestScore + X15_Parkiteer + X16_CBDDist +X17_ACDist + X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+ X29_MeanSize + X31_PropOS + X32_PropBach, data = Stratifiedsample.train.800.rd4)
Melb.trainStratified.LM.7.1<-lm.beta(Melb.trainStratified.LM.7.1)
summary(Melb.trainStratified.LM.7.1)
capture.output(summary(Melb.trainStratified.LM.7.1), file = "trainStratified.MA.txt")
#Check VIF scores
Train.Stratified.PM.v2.VIF<- vif(Melb.trainStratified.LM.7.1)
Train.Stratified.PM.v2.VIF
Melb.trainStratified.LM.7.1<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X21_PropUrban + X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +  X11_IntDensity + X13_DestScore + X15_Parkiteer + X16_CBDDist +X17_ACDist + X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS	+ X29_MeanSize + X31_PropOS + X32_PropBach, data = Stratifiedsample.train.800.rd4)
#Check VIF scores
Train.Stratified.PM.v2.VIF<- vif(Melb.trainStratified.LM.7.1)
Train.Stratified.PM.v2.VIF
Train.Stratified.PM.v2.VIF<- vif(Melb.trainStratified.LM.5.9)
capture.output(Train.Stratified.PM.v2.VIF, file = "trainStratified.PM.v2.VIF.txt")
Train.Stratified.PM.v2.VIF
#ACDist
Melb.trainStratified.LM.5.9<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance +X15_Parkiteer + X18_ACCount + X19._FTZ +X20.Parking_m.2 + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X32_PropBach, data = Stratifiedsample.train.800.rd4)
Melb.trainStratified.LM.5.9<-lm.beta(Melb.trainStratified.LM.5.9)
summary(Melb.trainStratified.LM.5.9)
capture.output(summary(Melb.trainStratified.LM.5.9), file = "trainStratified.PM.v2.txt")
#explanatory power significantly improved
capture.output(summary(Melb.trainStratified.LM.5.1), file = "trainStratified.MA.txt")
Melb.tramStratified.LM.2.1_MA<-lm.beta(Melb.tramStratified.LM.2.1)
rm(Melb.tramStratified.LM.2.1_MA)
Tram.Stratified.LM.2.MA.VIF<- vif(Melb.tramStratified.LM.2.1)
Tram.Stratified.LM.2.MA.VIF
Tram.Stratified.LM.2.VIF
Melb_Data<- read.csv("BE-TR_AllStops_data.csv", header=TRUE, sep=",")
row.names(Melb_Data) <- Melb_Data[,c(2)]
View(AllStops_Data)
Stratifiedsample.bus.400<- Melb_Data[which (Melb_Data$Mode.Standard == 'Yes'),]
Allmodes<- Melb_Data[which (Melb_Data$Mode.Standard == 'Yes'),]
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X20.Parking_m.2 +  X22_EmpAccess + X23_C_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X17_ACDist + X18_ACCount + X20.Parking_m.2 +  X22_EmpAccess + X23_C_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes<- Melb_Data[which (Melb_Data$Mode.Standard == 'yes'),]
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes<- Melb_Data[which (Melb_Data$Mode.standard == 'yes'),]
Allmodes<- Melb_Data[which (Melb_Data$Standard. == 'yes'),]
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X27_O_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF
Allmodes.VIF<-vif(lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes))
Allmodes.VIF
View(Allmodes)
#step 4 Simple correlations
Corrdata.Allmodes<-Allmodes[,c(52, 54, 24, 26:31, 33:44, 49, 50, 55, 56)]
#Option 1 for Correlation matrices with p-values
Corrdata.Allmodes<-rcorr(as.matrix(Corrdata.Allmodes))
#option 2 for flat correlation matrix
#Set up a custom function to flatten
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
options(max.print=1000000)
Corrdata.Allmodes<-flattenCorrMatrix(Corrdata.Allmodes$r,Corrdata.Allmodes$P)
#Option 1 for Correlation matrices with p-values
Corrdata.Allmodes<-rcorr(as.matrix(Corrdata.Allmodes))
library(Hmisc)#rcorr function
#option 2 for flat correlation matrix
#Set up a custom function to flatten
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
Corrdata.Allmodes<-flattenCorrMatrix(Corrdata.Allmodes$r,Corrdata.Allmodes$P)
#Option 1 for Correlation matrices with p-values
Corrdata.Allmodes<-rcorr(as.matrix(Corrdata.Allmodes))
Corrdata.Allmodes<-flattenCorrMatrix(Corrdata.Allmodes$r,Corrdata.Allmodes$P)
capture.output(Corrdata.Allmodes,file="Corrdata.allmodes.csv")
#Step 4 maximally adjusted model
Allmodes.LM.1<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes)
Allmodes.LM.11<-lm.beta(Allmodes.LM.1)
summary(Allmodes.LM.1)
Allmodes.LM.1<-lm.beta(Allmodes.LM.1)
summary(Allmodes.LM.1)
capture.output(summary(Allmodes.LM.1), file = "Allmodes.MA.txt")
#AcDist
Allmodes.LM.1.2<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes)
Allmodes.LM.1.2<-lm.beta(Allmodes.LM.1.2)
summary(Allmodes.LM.1.2)
#Intersection density
Allmodes.LM.1.3<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes)
Allmodes.LM.1.3<-lm.beta(Allmodes.LM.1.3)
summary(Allmodes.LM.1.3)
#FTZ
Allmodes.LM.1.4<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes)
Allmodes.LM.1.4<-lm.beta(Allmodes.LM.1.4)
summary(Allmodes.LM.1.4)
#cycleconnect
Allmodes.LM.1.5<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv + X13_DestScore + X15_Parkiteer + X16_CBDDist + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes)
Allmodes.LM.1.5<-lm.beta(Allmodes.LM.1.5)
summary(Allmodes.LM.1.5)
#PropComm
Allmodes.LM.1.6<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance + X9_LUEntropy + X10_HousingDiv + X13_DestScore + X15_Parkiteer + X16_CBDDist + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes)
Allmodes.LM.1.5<-lm.beta(Allmodes.LM.1.5)
Allmodes.LM.1.6<-lm.beta(Allmodes.LM.1.6)
summary(Allmodes.LM.1.6)
#CBDDist
Allmodes.LM.1.7<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X8_Balance + X9_LUEntropy + X10_HousingDiv + X13_DestScore + X15_Parkiteer + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes)
Allmodes.LM.1.7<-lm.beta(Allmodes.LM.1.7)
summary(Allmodes.LM.1.7)
par(mfrow=c(2,2))
plot(Allmodes.LM.1.7)
which(rownames(Allmodes) == "1498-bus") #156
which(rownames(Allmodes == "1498-bus") #156
which(rownames(Allmodes == "1498-bus")) #156
which(rownames(Allmodes) == "158-tram") #194
Allmodes.rd2 <- Allmodes[-c(9474,10153),]
#Round 2 MA
Allmodes.LM.2.1<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X11_IntDensity + X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes.rd2)
Allmodes.LM.2.1<-lm.beta(Allmodes.LM.2.1)
summary(Allmodes.LM.2.1)
capture.output(summary(Allmodes.LM.2.1), file = "Allmodes.MA.txt")
#int density
Allmodes.LM.2.2<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X17_ACDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes.rd2)
Allmodes.LM.2.2<-lm.beta(Allmodes.LM.2.2)
summary(Allmodes.LM.2.2)
#AC Dist
Allmodes.LM.2.3<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv +X12_CycleConnect + X13_DestScore + X15_Parkiteer + X16_CBDDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes.rd2)
Allmodes.LM.2.3<-lm.beta(Allmodes.LM.2.3)
summary(Allmodes.LM.2.3)
#Cycleconnect
Allmodes.LM.2.4<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv + X13_DestScore + X15_Parkiteer + X16_CBDDist + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes.rd2)
Allmodes.LM.2.4<-lm.beta(Allmodes.LM.2.4)
summary(Allmodes.LM.2.4)
#CBDDist
Allmodes.LM.2.5<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv + X13_DestScore + X15_Parkiteer + X18_ACCount + X19._FTZ + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes.rd2)
Allmodes.LM.2.5<-lm.beta(Allmodes.LM.2.5)
summary(Allmodes.LM.2.5)
#FTZ
Allmodes.LM.2.6<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv + X13_DestScore + X15_Parkiteer + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X26_O_Train_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes.rd2)
Allmodes.LM.2.6<-lm.beta(Allmodes.LM.2.6)
summary(Allmodes.LM.2.6)
#O_Train
Allmodes.LM.2.7<-lm(X1ln.ln_Patronage ~ X3ln.ln_Pop+ X6_PropComm + X8_Balance + X9_LUEntropy + X10_HousingDiv + X13_DestScore + X15_Parkiteer + X18_ACCount + X20.Parking_m.2 + X21_PropUrban + X22_EmpAccess + X23_C_LOS + X24_O_Bus_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X31_PropOS + X32_PropBach, data =Allmodes.rd2)
Allmodes.LM.2.7<-lm.beta(Allmodes.LM.2.7)
summary(Allmodes.LM.2.7)
plot(Allmodes.LM.2.7)
capture.output(summary(Allmodes.LM.2.1), file = "Allmodes.MA.txt")
capture.output(summary(Allmodes.LM.2.2), file = "Allmodes.PM.v2.txt")
Allmodes.VIF<- vif(Allmodes.LM.2.2)
Allmodes.LM.VIF
capture.output(summary(Allmodes.LM.2.7), file = "Allmodes.PM.v2.txt")
Allmodes.VIF<- vif(Allmodes.LM.2.7)
Allmodes.VIF
capture.output(Allmodes.VIF, file = "Allmodes.VIF.txt")
install.packages("tidyverse")  # data manipulation
install.packages("cluster")  # clustering algorithms
install.packages("factoextra") # clustering visualization
install.packages("gridExtra")
library(tidyverse)  # data manipulation
library(cluster)   # clustering algorithms
library(dplyr)# mutate function
library(car)#VIF function
library(Hmisc)#rcorr function
library(lm.beta)
options(max.print= 1000000)
setwd("C:/Users/lkast1/Google Drive/PhD/2.Analysis/2. Empirical Analysis/BE-TR_Multi Country Samples/Melbourne/Melb.All.Stops/Melb.AllStops.Repo/Data")
Melb_Data<- read.csv("BE-TR_AllStops_data.csv", header=TRUE, sep=",")
row.names(Melb_Data) <- Melb_Data[,c(2)]
Stratifiedsample.tram.600<- Melb_Data[which (Melb_Data$Mode=='tram'
& Melb_Data$Sample=='Yes'),]
row.names(Stratifiedsample.tram.600) <- Stratifiedsample.tram.600[,c(2)]
#MA tram
Melb.tramStratified.LM.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
summary(Melb.tramStratified.LM.1)
Melb.tramStratified.LM.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
#'Tram
#'VIF for emp access and CBD dist may be causing unexpected result for CBD dist. remove.
#MA tram
Melb.tramStratified.LM.1.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
summary(Melb.tramStratified.LM.1.1)
Melb.tramStratified.LM.1.1<-lm.beta(Melb.tramStratified.LM.1.1)
summary(Melb.tramStratified.LM.1.1)
Melb.tramStratified.LM.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.regb<-step(Melb.tramStratified.LM.1,
direction = "backward",
trace = 0) #don't print steps
summary(Melb.tramStratified.LM.1.regb)
#MA tram rd 2
Melb.tramStratified.LM.2.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.1.regb<-step(Melb.tramStratified.LM.2.1,
direction = "backward",
trace = 0) #don't print steps
summary(Melb.tramStratified.LM.2.1.regb)
#MA tram rd 2
Melb.tramStratified.LM.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
plot(Melb.tramStratified.LM.1.6)
which(rownames(Stratifiedsample.tram.600) == "1913-tram") #62
Stratifiedsample.tram.600.rd2 <- Stratifiedsample.tram.600[-c(81, 8, 62),]
#diagnostics
par(mfrow=c(2,2))
plot(Melb.tramStratified.LM.1.6)
#MA tram rd 2
Melb.tramStratified.LM.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.regb<-step(Melb.tramStratified.LM.2,
direction = "backward",
trace = 0) #don't print steps
plot(Melb.tramStratified.LM.2.regb)
which(rownames(Stratifiedsample.tram.600) == "278-tram") #81
Stratifiedsample.tram.600.rd2 <- Stratifiedsample.tram.600[-c(81),]
#MA tram rd 2
Melb.tramStratified.LM.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.regb<-step(Melb.tramStratified.LM.2,
direction = "backward",
trace = 0) #don't print steps
summary(Melb.tramStratified.LM.2.regb)
plot(Melb.tramStratified.LM.2.regb)
#278, #2213 is influential outlier
#1913-tram is outside Cook's distance
which(rownames(Stratifiedsample.tram.600) == "278-tram") #81
Stratifiedsample.tram.600.rd2 <- Stratifiedsample.tram.600[-c(81),]
#MA tram rd 2
Melb.tramStratified.LM.2.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.1.regb<-step(Melb.tramStratified.LM.2.1,
direction = "backward",
trace = 0) #don't print steps
summary(Melb.tramStratified.LM.2.1.regb)
plot((Melb.tramStratified.LM.2.1.regb)
plot(Melb.tramStratified.LM.2.1.regb)
plot(Melb.tramStratified.LM.2.1.regb)
plot(Melb.tramStratified.LM.2.1.regb)
#'Tram
#'VIF for emp access and CBD dist may be causing unexpected result for CBD dist. remove.
#MA tram
Melb.tramStratified.LM.1.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.1.regb<-step(Melb.tramStratified.LM.1.1,
direction = "backward",
trace = 0)
plot(Melb.tramStratified.LM.1.1.regb)
library(tidyverse)  # data manipulation
library(gridExtra)
library(dplyr)# mutate function
library(car)#VIF function
library(Hmisc)#rcorr function
library(lm.beta)
setwd("C:/Users/lkast1/Google Drive/PhD/2.Analysis/2. Empirical Analysis/BE-TR_Multi Country Samples/Melbourne/Melb.All.Stops/Melb.AllStops.Repo/Data")
#Refer to sampling script
Melb_Data<- read.csv("BE-TR_AllStops_data.csv", header=TRUE, sep=",")
row.names(Melb_Data) <- Melb_Data[,c(2)]
Stratifiedsample.tram.600<- Melb_Data[which (Melb_Data$Mode=='tram'
& Melb_Data$Sample=='Yes'),]
row.names(Stratifiedsample.tram.600) <- Stratifiedsample.tram.600[,c(2)]
#'Tram
#'VIF for emp access and CBD dist may be causing unexpected result for CBD dist. remove.
#MA tram
Melb.tramStratified.LM.1.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.1<-lm.beta(Melb.tramStratified.LM.1.1)
summary(Melb.tramStratified.LM.1.1)
options(scipen = 999)
#2 remove AC Count
Melb.tramStratified.LM.1.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.2<-lm.beta(Melb.tramStratified.LM.1.2)
summary(Melb.tramStratified.LM.1.2)
#3 remove PropBach
Melb.tramStratified.LM.1.3<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.3<-lm.beta(Melb.tramStratified.LM.1.3)
summary(Melb.tramStratified.LM.1.3)
#4 remove HousingDiv
Melb.tramStratified.LM.1.4<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.4<-lm.beta(Melb.tramStratified.LM.1.4)
summary(Melb.tramStratified.LM.1.4)
#5 remove Int Density
Melb.tramStratified.LM.1.5<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.5<-lm.beta(Melb.tramStratified.LM.1.5)
summary(Melb.tramStratified.LM.1.5)
#6 remove FTZ
Melb.tramStratified.LM.1.6<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.6<-lm.beta(Melb.tramStratified.LM.1.6)
summary(Melb.tramStratified.LM.1.6)
#6 remove O_Tram_LOS (not logical)
Melb.tramStratified.LM.1.7<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X22_EmpAccess + X23_C_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.7<-lm.beta(Melb.tramStratified.LM.1.7)
summary(Melb.tramStratified.LM.1.7)
#meansize
Melb.tramStratified.LM.1.8<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X22_EmpAccess + X23_C_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.8<-lm.beta(Melb.tramStratified.LM.1.8)
summary(Melb.tramStratified.LM.1.8)
plot(Melb.tramStratified.LM.1.8)
#1913-tram is outside Cook's distance
which(rownames(Stratifiedsample.tram.600) == "278-tram") #81
which(rownames(Stratifiedsample.tram.600) == "2213-tram") #8
#diagnostics
par(mfrow=c(2,2))
plot(Melb.tramStratified.LM.1.8)
plot(Melb.tramStratified.LM.1.6)
Stratifiedsample.tram.600.rd2 <- Stratifiedsample.tram.600[-c(81, 62),]
#MA tram rd 2
Melb.tramStratified.LM.2.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.1<-lm.beta(Melb.tramStratified.LM.2.1)
summary(Melb.tramStratified.LM.2.1)
#2 remove AC Count
Melb.tramStratified.LM.2.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.2<-lm.beta(Melb.tramStratified.LM.2.2)
summary(Melb.tramStratified.LM.2.2)
Melb.tramStratified.LM.2.3<-lm.beta(Melb.tramStratified.LM.2.3)
#3 remove HousingDiv
Melb.tramStratified.LM.2.3<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.3<-lm.beta(Melb.tramStratified.LM.2.3)
summary(Melb.tramStratified.LM.2.3)
#4 remove PropBach
Melb.tramStratified.LM.2.4<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.4<-lm.beta(Melb.tramStratified.LM.2.4)
summary(Melb.tramStratified.LM.2.4)
#MA tram rd 2
Melb.tramStratified.LM.2.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.1<-lm.beta(Melb.tramStratified.LM.2.1)
summary(Melb.tramStratified.LM.2.1)
#2 remove AC Count
Melb.tramStratified.LM.2.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.2<-lm.beta(Melb.tramStratified.LM.2.2)
summary(Melb.tramStratified.LM.2.2)
#3 remove Mean Size
Melb.tramStratified.LM.2.3<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.3<-lm.beta(Melb.tramStratified.LM.2.3)
summary(Melb.tramStratified.LM.2.3)
#3 remove PropBach
Melb.tramStratified.LM.2.4<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
#3 remove PropBach
Melb.tramStratified.LM.2.4<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.4<-lm.beta(Melb.tramStratified.LM.2.4)
summary(Melb.tramStratified.LM.2.4)
#3 remove HousingDiv
Melb.tramStratified.LM.2.5<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.5<-lm.beta(Melb.tramStratified.LM.2.5)
summary(Melb.tramStratified.LM.2.5)
#3 remove FTZ
Melb.tramStratified.LM.2.6<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.6<-lm.beta(Melb.tramStratified.LM.2.6)
summary(Melb.tramStratified.LM.2.6)
plot(Melb.tramStratified.LM.2.6)
library(tidyverse)  # data manipulation
library(gridExtra)
library(dplyr)# mutate function
library(car)#VIF function
library(Hmisc)#rcorr function
library(lm.beta)
options(max.print= 1000000)
setwd("C:/Users/lkast1/Google Drive/PhD/2.Analysis/2. Empirical Analysis/BE-TR_Multi Country Samples/Melbourne/Melb.All.Stops/Melb.AllStops.Repo/Data")
#Refer to sampling script
Melb_Data<- read.csv("BE-TR_AllStops_data.csv", header=TRUE, sep=",")
row.names(Melb_Data) <- Melb_Data[,c(2)]
Stratifiedsample.tram.600<- Melb_Data[which (Melb_Data$Mode=='tram'
& Melb_Data$Sample=='Yes'),]
row.names(Stratifiedsample.tram.600) <- Stratifiedsample.tram.600[,c(2)]
#'Tram
#'VIF for emp access and CBD dist may be causing unexpected result for CBD dist. remove.
#MA tram
Melb.tramStratified.LM.1.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.1<-lm.beta(Melb.tramStratified.LM.1.1)
summary(Melb.tramStratified.LM.1.1)
options(scipen = 999)
#diagnostics
par(mfrow=c(2,2))
#6 remove FTS
Melb.tramStratified.LM.1.6<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.6<-lm.beta(Melb.tramStratified.LM.1.6)
summary(Melb.tramStratified.LM.1.6)
#6 remove O-tram
Melb.tramStratified.LM.1.7<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X22_EmpAccess + X23_C_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.7<-lm.beta(Melb.tramStratified.LM.1.7)
summary(Melb.tramStratified.LM.1.7)
plot(Melb.tramStratified.LM.1.7)
Stratifiedsample.tram.600.rd2 <- Stratifiedsample.tram.600[-c(81),]
#MA tram rd 2
Melb.tramStratified.LM.2.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.1<-lm.beta(Melb.tramStratified.LM.2.1)
summary(Melb.tramStratified.LM.2.1)
#Housing Div
Melb.tramStratified.LM.2.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.1<-lm.beta(Melb.tramStratified.LM.2.1)
summary(Melb.tramStratified.LM.2.1)
#PropBach
Melb.tramStratified.LM.2.3<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.3<-lm.beta(Melb.tramStratified.LM.2.3)
summary(Melb.tramStratified.LM.2.3)
#FTZ
Melb.tramStratified.LM.2.4<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.4<-lm.beta(Melb.tramStratified.LM.2.4)
summary(Melb.tramStratified.LM.2.4)
#MeanSize
Melb.tramStratified.LM.2.5<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.5<-lm.beta(Melb.tramStratified.LM.2.5)
summary(Melb.tramStratified.LM.2.5)
#ACCount
Melb.tramStratified.LM.2.6<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.6<-lm.beta(Melb.tramStratified.LM.2.6)
summary(Melb.tramStratified.LM.2.6)
#O_Tram_LOS
Melb.tramStratified.LM.2.7<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +X22_EmpAccess + X23_C_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.7<-lm.beta(Melb.tramStratified.LM.2.7)
summary(Melb.tramStratified.LM.2.7)
plot(Melb.tramStratified.LM.2.7)
which(rownames(Stratifiedsample.tram.600.rd2) == "214-tram") #81
which(rownames(Stratifiedsample.tram.600.rd2) == "2213-tram") #8
which(rownames(Stratifiedsample.tram.600.rd2) == "1913-tram") #62
Stratifiedsample.tram.600.rd3 <- Stratifiedsample.tram.600.rd2[-c(76, 8, 62),]
#MA rd 3
Melb.tramStratified.LM.3.1<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd3)
Melb.tramStratified.LM.3.1<-lm.beta(Melb.tramStratified.LM.3.1)
summary(Melb.tramStratified.LM.3.1)
#HousingDiv
Melb.tramStratified.LM.3.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X18_ACCount + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd3)
Melb.tramStratified.LM.3.2<-lm.beta(Melb.tramStratified.LM.3.2)
summary(Melb.tramStratified.LM.3.2)
#ACCount
Melb.tramStratified.LM.3.3<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist + X19._FTZ +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd3)
Melb.tramStratified.LM.3.3<-lm.beta(Melb.tramStratified.LM.3.3)
summary(Melb.tramStratified.LM.3.3)
#FTZ
Melb.tramStratified.LM.3.4<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist + 22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd3)
Melb.tramStratified.LM.3.4<-lm.beta(Melb.tramStratified.LM.3.4)
#FTZ
Melb.tramStratified.LM.3.4<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600.rd3)
Melb.tramStratified.LM.3.4<-lm.beta(Melb.tramStratified.LM.3.4)
summary(Melb.tramStratified.LM.3.4)
#PropBach
Melb.tramStratified.LM.3.5<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize, data =Stratifiedsample.tram.600.rd3)
Melb.tramStratified.LM.3.5<-lm.beta(Melb.tramStratified.LM.3.5)
summary(Melb.tramStratified.LM.3.5)
#MeanSize
Melb.tramStratified.LM.3.6<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd3)
Melb.tramStratified.LM.3.6<-lm.beta(Melb.tramStratified.LM.3.6)
summary(Melb.tramStratified.LM.3.6)
library(tidyverse)  # data manipulation
library(gridExtra)
library(dplyr)# mutate function
library(car)#VIF function
library(Hmisc)#rcorr function
library(lm.beta)
options(max.print= 1000000)
setwd("C:/Users/lkast1/Google Drive/PhD/2.Analysis/2. Empirical Analysis/BE-TR_Multi Country Samples/Melbourne/Melb.All.Stops/Melb.AllStops.Repo/Data")
#Refer to sampling script
Melb_Data<- read.csv("BE-TR_AllStops_data.csv", header=TRUE, sep=",")
row.names(Melb_Data) <- Melb_Data[,c(2)]
Stratifiedsample.tram.600<- Melb_Data[which (Melb_Data$Mode=='tram'
& Melb_Data$Sample=='Yes'),]
ow.names(Stratifiedsample.tram.600) <- Stratifiedsample.tram.600[,c(2)]
row.names(Stratifiedsample.tram.600) <- Stratifiedsample.tram.600[,c(2)]
#2 remove AC Count
Melb.tramStratified.LM.1.2<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop + X6_PropComm + X10_HousingDiv + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +  X19._FTZ + X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE	+ X29_Censored_MeanSize + X32_PropBach, data =Stratifiedsample.tram.600)
Melb.tramStratified.LM.1.2<-lm.beta(Melb.tramStratified.LM.1.2)
summary(Melb.tramStratified.LM.1.2)
#6 remove mean size
Melb.tramStratified.LM.2.6<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.6<-lm.beta(Melb.tramStratified.LM.2.6)
summary(Melb.tramStratified.LM.2.6)
Stratifiedsample.tram.600.rd2 <- Stratifiedsample.tram.600[-c(81, 8, 62),]
#6 remove mean size
Melb.tramStratified.LM.2.6<-lm(X1ln.ln_Patronage ~  X3ln.ln_Pop+ X6_PropComm + X11_IntDensity + X12_CycleConnect + X13_DestScore + X16_CBDDist +X22_EmpAccess + X23_C_LOS + X25_O_Tram_LOS + X28_Censored_PropFTE, data =Stratifiedsample.tram.600.rd2)
Melb.tramStratified.LM.2.6<-lm.beta(Melb.tramStratified.LM.2.6)
summary(Melb.tramStratified.LM.2.6)
#diagnostics
par(mfrow=c(2,2))
plot(Melb.tramStratified.LM.2.6)
View(Allmodes.Melb.800)
